from functools import partial

from tremendous.api import (
    apply_format,
    apply_256,
    apply_256_bg,
    apply_256_hl,
)
from tremendous.bindings import lib as __lib
from tremendous.bindings import ffi

colors_16 = dict(
    bold=__lib.BOLD,
    italic=__lib.ITALIC,
    under=__lib.UNDER,
    under2=__lib.UNDER2,
    strike=__lib.STRIKE,
    blink=__lib.BLINK,
    flip=__lib.FLIP,
    black=__lib.BLACK,
    red=__lib.RED,
    green=__lib.GREEN,
    yellow=__lib.YELLOW,
    blue=__lib.BLUE,
    magenta=__lib.MAGENTA,
    cyan=__lib.CYAN,
    white=__lib.WHITE,
    hblack=__lib.HBLACK,
    hred=__lib.HRED,
    hgreen=__lib.HGREEN,
    hyellow=__lib.HYELLOW,
    hblue=__lib.HBLUE,
    hmagenta=__lib.HMAGENTA,
    hcyan=__lib.HCYAN,
    hwhite=__lib.HWHITE,
    bgblack=__lib.BGBLACK,
    bgred=__lib.BGRED,
    bggreen=__lib.BGGREEN,
    bgyellow=__lib.BGYELLOW,
    bgblue=__lib.BGBLUE,
    bgmagenta=__lib.BGMAGENTA,
    bgcyan=__lib.BGCYAN,
    bgwhite=__lib.BGWHITE,
)

__funcs = {}
# This is also gross. Sorry.
for k, v in colors_16.items():
    if k.startswith('h'):
        __funcs['highlight_' + k[1:]] = partial(apply_format, v)
        __funcs['hi_' + k[1:]] = partial(apply_format, v)
        __funcs['hl_' + k[1:]] = partial(apply_format, v)
    elif k.startswith('bg'):
        __funcs['background_' + k[1:]] = partial(apply_format, v)
        __funcs['bg_' + k[2:]] = partial(apply_format, v)
    elif k.startswith('under'):
        __funcs[k] = partial(apply_format, v)
        __funcs['underline' + k[5:]] = partial(apply_format, v)
    else:
        __funcs[k] = partial(apply_format, v)


extended_colors = {
    'Grey0':             [0,   0,   0],
    'NavyBlue':          [0,   0,   95],
    'DarkBlue':          [0,   0,   135],
    'Blue3':             [0,   0,   175],
    'Blue3':             [0,   0,   215],
    'Blue1':             [0,   0,   255],
    'DarkGreen':         [0,   95,  0],
    'DeepSkyBlue4':      [0,   95,  95],
    'DeepSkyBlue4':      [0,   95,  135],
    'DeepSkyBlue4':      [0,   95,  175],
    'DodgerBlue3':       [0,   95,  215],
    'DodgerBlue2':       [0,   95,  255],
    'Green4':            [0,   135, 0],
    'SpringGreen4':      [0,   135, 95],
    'Turquoise4':        [0,   135, 135],
    'DeepSkyBlue3':      [0,   135, 175],
    'DeepSkyBlue3':      [0,   135, 215],
    'DodgerBlue1':       [0,   135, 255],
    'Green3':            [0,   175, 0],
    'SpringGreen3':      [0,   175, 95],
    'DarkCyan':          [0,   175, 135],
    'LightSeaGreen':     [0,   175, 175],
    'DeepSkyBlue2':      [0,   175, 215],
    'DeepSkyBlue1':      [0,   175, 255],
    'Green3':            [0,   215, 0],
    'SpringGreen3':      [0,   215, 95],
    'SpringGreen2':      [0,   215, 135],
    'Cyan3':             [0,   215, 175],
    'DarkTurquoise':     [0,   215, 215],
    'Turquoise2':        [0,   215, 255],
    'Green1':            [0,   255, 0],
    'SpringGreen2':      [0,   255, 95],
    'SpringGreen1':      [0,   255, 135],
    'MediumSpringGreen': [0,   255, 175],
    'Cyan2':             [0,   255, 215],
    'Cyan1':             [0,   255, 255],
    'DarkRed':           [95,  0,   0],
    'DeepPink4':         [95,  0,   95],
    'Purple4':           [95,  0,   135],
    'Purple4':           [95,  0,   175],
    'Purple3':           [95,  0,   215],
    'BlueViolet':        [95,  0,   255],
    'Orange4':           [95,  95,  0],
    'Grey37':            [95,  95,  95],
    'MediumPurple4':     [95,  95,  135],
    'SlateBlue3':        [95,  95,  175],
    'SlateBlue3':        [95,  95,  215],
    'RoyalBlue1':        [95,  95,  255],
    'Chartreuse4':       [95,  135, 0],
    'DarkSeaGreen4':     [95,  135, 95],
    'PaleTurquoise4':    [95,  135, 135],
    'SteelBlue':         [95,  135, 175],
    'SteelBlue3':        [95,  135, 215],
    'CornflowerBlue':    [95,  135, 255],
    'Chartreuse3':       [95,  175, 0],
    'DarkSeaGreen4':     [95,  175, 95],
    'CadetBlue':         [95,  175, 135],
    'CadetBlue':         [95,  175, 175],
    'SkyBlue3':          [95,  175, 215],
    'SteelBlue1':        [95,  175, 255],
    'Chartreuse3':       [95,  215, 0],
    'PaleGreen3':        [95,  215, 95],
    'SeaGreen3':         [95,  215, 135],
    'Aquamarine3':       [95,  215, 175],
    'MediumTurquoise':   [95,  215, 215],
    'SteelBlue1':        [95,  215, 255],
    'Chartreuse2':       [95,  255, 0],
    'SeaGreen2':         [95,  255, 95],
    'SeaGreen1':         [95,  255, 135],
    'SeaGreen1':         [95,  255, 175],
    'Aquamarine1':       [95,  255, 215],
    'DarkSlateGray2':    [95,  255, 255],
    'DarkRed':           [135, 0,   0],
    'DeepPink4':         [135, 0,   95],
    'DarkMagenta':       [135, 0,   135],
    'DarkMagenta':       [135, 0,   175],
    'DarkViolet':        [135, 0,   215],
    'Purple':            [135, 0,   255],
    'Orange4':           [135, 95,  0],
    'LightPink4':        [135, 95,  95],
    'Plum4':             [135, 95,  135],
    'MediumPurple3':     [135, 95,  175],
    'MediumPurple3':     [135, 95,  215],
    'SlateBlue1':        [135, 95,  255],
    'Yellow4':           [135, 135, 0],
    'Wheat4':            [135, 135, 95],
    'Grey53':            [135, 135, 135],
    'LightSlateGrey':    [135, 135, 175],
    'MediumPurple':      [135, 135, 215],
    'LightSlateBlue':    [135, 135, 255],
    'Yellow4':           [135, 175, 0],
    'DarkOliveGreen3':   [135, 175, 95],
    'DarkSeaGreen':      [135, 175, 135],
    'LightSkyBlue3':     [135, 175, 175],
    'LightSkyBlue3':     [135, 175, 215],
    'SkyBlue2':          [135, 175, 255],
    'Chartreuse2':       [135, 215, 0],
    'DarkOliveGreen3':   [135, 215, 95],
    'PaleGreen3':        [135, 215, 135],
    'DarkSeaGreen3':     [135, 215, 175],
    'DarkSlateGray3':    [135, 215, 215],
    'SkyBlue1':          [135, 215, 255],
    'Chartreuse1':       [135, 255, 0],
    'LightGreen':        [135, 255, 95],
    'LightGreen':        [135, 255, 135],
    'PaleGreen1':        [135, 255, 175],
    'Aquamarine1':       [135, 255, 215],
    'DarkSlateGray1':    [135, 255, 255],
    'Red3':              [175, 0,   0],
    'DeepPink4':         [175, 0,   95],
    'MediumVioletRed':   [175, 0,   135],
    'Magenta3':          [175, 0,   175],
    'DarkViolet':        [175, 0,   215],
    'Purple':            [175, 0,   255],
    'DarkOrange3':       [175, 95,  0],
    'IndianRed':         [175, 95,  95],
    'HotPink3':          [175, 95,  135],
    'MediumOrchid3':     [175, 95,  175],
    'MediumOrchid':      [175, 95,  215],
    'MediumPurple2':     [175, 95,  255],
    'DarkGoldenrod':     [175, 135, 0],
    'LightSalmon3':      [175, 135, 95],
    'RosyBrown':         [175, 135, 135],
    'Grey63':            [175, 135, 175],
    'MediumPurple2':     [175, 135, 215],
    'MediumPurple1':     [175, 135, 255],
    'Gold3':             [175, 175, 0],
    'DarkKhaki':         [175, 175, 95],
    'NavajoWhite3':      [175, 175, 135],
    'Grey69':            [175, 175, 175],
    'LightSteelBlue3':   [175, 175, 215],
    'LightSteelBlue':    [175, 175, 255],
    'Yellow3':           [175, 215, 0],
    'DarkOliveGreen3':   [175, 215, 95],
    'DarkSeaGreen3':     [175, 215, 135],
    'DarkSeaGreen2':     [175, 215, 175],
    'LightCyan3':        [175, 215, 215],
    'LightSkyBlue1':     [175, 215, 255],
    'GreenYellow':       [175, 255, 0],
    'DarkOliveGreen2':   [175, 255, 95],
    'PaleGreen1':        [175, 255, 135],
    'DarkSeaGreen2':     [175, 255, 175],
    'DarkSeaGreen1':     [175, 255, 215],
    'PaleTurquoise1':    [175, 255, 255],
    'Red3':              [215, 0,   0],
    'DeepPink3':         [215, 0,   95],
    'DeepPink3':         [215, 0,   135],
    'Magenta3':          [215, 0,   175],
    'Magenta3':          [215, 0,   215],
    'Magenta2':          [215, 0,   255],
    'DarkOrange3':       [215, 95,  0],
    'IndianRed':         [215, 95,  95],
    'HotPink3':          [215, 95,  135],
    'HotPink2':          [215, 95,  175],
    'Orchid':            [215, 95,  215],
    'MediumOrchid1':     [215, 95,  255],
    'Orange3':           [215, 135, 0],
    'LightSalmon3':      [215, 135, 95],
    'LightPink3':        [215, 135, 135],
    'Pink3':             [215, 135, 175],
    'Plum3':             [215, 135, 215],
    'Violet':            [215, 135, 255],
    'Gold3':             [215, 175, 0],
    'LightGoldenrod3':   [215, 175, 95],
    'Tan':               [215, 175, 135],
    'MistyRose3':        [215, 175, 175],
    'Thistle3':          [215, 175, 215],
    'Plum2':             [215, 175, 255],
    'Yellow3':           [215, 215, 0],
    'Khaki3':            [215, 215, 95],
    'LightGoldenrod2':   [215, 215, 135],
    'LightYellow3':      [215, 215, 175],
    'Grey84':            [215, 215, 215],
    'LightSteelBlue1':   [215, 215, 255],
    'Yellow2':           [215, 255, 0],
    'DarkOliveGreen1':   [215, 255, 95],
    'DarkOliveGreen1':   [215, 255, 135],
    'DarkSeaGreen1':     [215, 255, 175],
    'Honeydew2':         [215, 255, 215],
    'LightCyan1':        [215, 255, 255],
    'Red1':              [255, 0,   0],
    'DeepPink2':         [255, 0,   95],
    'DeepPink1':         [255, 0,   135],
    'DeepPink1':         [255, 0,   175],
    'Magenta2':          [255, 0,   215],
    'Magenta1':          [255, 0,   255],
    'OrangeRed1':        [255, 95,  0],
    'IndianRed1':        [255, 95,  95],
    'IndianRed1':        [255, 95,  135],
    'HotPink':           [255, 95,  175],
    'HotPink':           [255, 95,  215],
    'MediumOrchid1':     [255, 95,  255],
    'DarkOrange':        [255, 135, 0],
    'Salmon1':           [255, 135, 95],
    'LightCoral':        [255, 135, 135],
    'PaleVioletRed1':    [255, 135, 175],
    'Orchid2':           [255, 135, 215],
    'Orchid1':           [255, 135, 255],
    'Orange1':           [255, 175, 0],
    'SandyBrown':        [255, 175, 95],
    'LightSalmon1':      [255, 175, 135],
    'LightPink1':        [255, 175, 175],
    'Pink1':             [255, 175, 215],
    'Plum1':             [255, 175, 255],
    'Gold1':             [255, 215, 0],
    'LightGoldenrod2':   [255, 215, 95],
    'LightGoldenrod2':   [255, 215, 135],
    'NavajoWhite1':      [255, 215, 175],
    'MistyRose1':        [255, 215, 215],
    'Thistle1':          [255, 215, 255],
    'Yellow1':           [255, 255, 0],
    'LightGoldenrod1':   [255, 255, 95],
    'Khaki1':            [255, 255, 135],
    'Wheat1':            [255, 255, 175],
    'Cornsilk1':         [255, 255, 215],
    'Grey100':           [255, 255, 255],
    'Grey3':             [8,   8,   8],
    'Grey7':             [18,  18,  18],
    'Grey11':            [28,  28,  28],
    'Grey15':            [38,  38,  38],
    'Grey19':            [48,  48,  48],
    'Grey23':            [58,  58,  58],
    'Grey27':            [68,  68,  68],
    'Grey30':            [78,  78,  78],
    'Grey35':            [88,  88,  88],
    'Grey39':            [98,  98,  98],
    'Grey42':            [108, 108, 108],
    'Grey46':            [118, 118, 118],
    'Grey50':            [128, 128, 128],
    'Grey54':            [138, 138, 138],
    'Grey58':            [148, 148, 148],
    'Grey62':            [158, 158, 158],
    'Grey66':            [168, 168, 168],
    'Grey70':            [178, 178, 178],
    'Grey74':            [188, 188, 188],
    'Grey78':            [198, 198, 198],
    'Grey82':            [208, 208, 208],
    'Grey85':            [218, 218, 218],
    'Grey89':            [228, 228, 228],
    'Grey93':            [238, 238, 238],
}

__extended_funcs = {}
# This is also gross. Sorry.
for k, v in extended_colors.items():
    color = ffi.new('rgb_t *', v)
    __extended_funcs[k.lower()] = partial(apply_256, v)
    __extended_funcs['bg_' + k.lower()] = partial(apply_256_bg, v)
    __extended_funcs['background_' + k.lower()] = partial(apply_256_bg, v)
    __extended_funcs['hl_' + k.lower()] = partial(apply_256_hl, v)
    __extended_funcs['highlight' + k.lower()] = partial(apply_256_hl, v)
